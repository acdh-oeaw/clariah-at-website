---
import type { HTMLAttributes } from "astro/types";

import { defaultLocale, type Locale } from "@/config/i18n.config";
import { ensureTrailingSlash } from "@/lib/ensure-trailing-slash";

interface Props extends HTMLAttributes<"a"> {
	locale?: Locale;
	reload?: boolean;
}

const { href, locale, reload, ...rest } = Astro.props;

const localisedHref =
	typeof href === "string" && href.startsWith("/") && !href.startsWith("/assets/")
		? "/" + (locale ?? Astro.currentLocale ?? defaultLocale) + ensureTrailingSlash(href)
		: href;
---

<a {...rest} data-astro-reload={reload} href={localisedHref}><slot /></a>
